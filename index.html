<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>EcoChem Tracker</title>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
<style>
  :root {
    --green-700: #2e7d32;
    --green-400: #66bb6a;
    --accent: #43a047;
  }
  body {
    font-family: 'Poppins', sans-serif;
    background: linear-gradient(to bottom right, #a8e6cf, #dcedc1);
    margin: 0;
    padding: 0;
    color: #222;
  }

  header {
    background-color: var(--green-700);
    color: white;
    text-align: center;
    padding: 1.25rem 1rem;
    box-shadow: 0 4px 10px rgba(0,0,0,0.15);
  }
  header h1 {
    margin: 0;
    font-size: 2.2rem;
    animation: glow 3s ease-in-out infinite alternate;
    letter-spacing: 1px;
  }
  header p { margin: 0.35rem 0 0; font-style: italic; opacity: 0.95; }

  @keyframes glow {
    from { text-shadow: 0 0 8px rgba(129,199,132,0.8); transform: translateY(0px); }
    to   { text-shadow: 0 0 22px rgba(200,230,201,0.95); transform: translateY(-2px); }
  }

  nav {
    display:flex;
    flex-wrap:wrap;
    justify-content:center;
    gap:0.6rem;
    padding:0.6rem;
    background: var(--green-400);
  }
  nav button {
    background:white;
    border:none;
    padding:0.55rem 1rem;
    border-radius:22px;
    cursor:pointer;
    font-weight:600;
    transition:all .18s ease;
  }
  nav button:hover { background:var(--accent); color:white; transform: translateY(-2px); }

  main { padding:1.6rem; max-width:1100px; margin:0 auto; }

  section { display:none; animation:fade 0.35s ease; }
  section.active { display:block; }
  @keyframes fade { from {opacity:0} to {opacity:1} }

  /* home layout */
  .home-grid {
    display:grid;
    gap:1rem;
    grid-template-columns: repeat(auto-fit, minmax(240px,1fr));
    margin-top:1rem;
  }
  .card {
    background:#f1f8e9;
    border-radius:10px;
    padding:1.1rem;
    box-shadow: 0 4px 8px rgba(0,0,0,0.06);
  }
  .card h3 { margin:0 0 .5rem; color:var(--green-700); }

  /* inputs + buttons */
  input[type=number], input[type=text] {
    padding:0.55rem;
    margin:.35rem 0;
    border-radius:8px;
    border:1px solid #cfd8cb;
    width:220px;
    box-sizing:border-box;
  }
  button.primary {
    background:var(--accent);
    border:none;
    color:white;
    padding:0.5rem 0.9rem;
    border-radius:8px;
    cursor:pointer;
    margin-top:0.5rem;
    font-weight:600;
  }
  button.primary:hover { opacity:0.95; transform:translateY(-1px); }

  .result { margin-top:0.8rem; font-weight:700; color:#1b5e20; }

  .progress-bar {
    background:#c8e6c9;
    height:18px;
    border-radius:18px;
    overflow:hidden;
    margin-top:0.7rem;
  }
  .progress { height:100%; width:0%; background:var(--accent); transition:width .4s ease; }

  .info-box {
    background:#fff;
    padding:0.9rem;
    border-left:6px solid var(--green-700);
    border-radius:8px;
    margin-top:0.9rem;
  }

  canvas {
    width:100% !important;
    height:260px !important;
    border-radius:8px;
    background: #f9fff9;
    box-shadow: 0 2px 6px rgba(0,0,0,0.06);
    display:block;
  }

  /* quiz */
  .quiz-answers { display:flex; flex-direction:column; gap:0.6rem; margin-top:0.6rem; }
  .quiz-answers button { padding:0.55rem; border-radius:8px; border:none; background:#e8f5e9; cursor:pointer; font-weight:600; }
  .quiz-answers button:hover { background:var(--accent); color:white; }

  footer {
    text-align:center;
    padding:1rem;
    background:var(--green-700);
    color:white;
    margin-top:1.8rem;
  }

  /* small screens */
  @media (max-width:420px) {
    input[type=number], input[type=text] { width:100%; }
  }
</style>
</head>
<body>
  <header>
    <h1>EcoChem Tracker üåø</h1>
    <p>Green Chemistry for a Sustainable Future ‚Äî STREAM-ready</p>
  </header>

  <nav>
    <button onclick="showSection('home')">üè† Home</button>
    <button onclick="showSection('calculator')">‚öóÔ∏è Calculator</button>
    <button onclick="showSection('simulator')">üß™ Simulator</button>
    <button onclick="showSection('quiz')">üß† Quiz</button>
    <button onclick="showSection('info')">üî¨ STREAM Info</button>
    <button onclick="showSection('tips')">üåé Eco Tips</button>
  </nav>

  <main>
    <section id="home" class="active">
      <h2>Welcome to EcoChem Tracker</h2>
      <p>Explore how chemistry and technology work together to protect our planet. Use the tools below to simulate reactions, calculate carbon footprints, visualize data, and test your knowledge.</p>

      <div class="home-grid">
        <div class="card">
          <h3>‚ôªÔ∏è Mission</h3>
          <p>Inspire students to combine Science, Technology, Reading/Research, Engineering, Art, and Math (STREAM) to solve sustainability challenges.</p>
        </div>

        <div class="card">
          <h3>üî¨ What you'll learn</h3>
          <ul>
            <li>How reactions produce byproducts and emissions</li>
            <li>How to estimate carbon cost of a reaction</li>
            <li>How data visualization helps decision-making</li>
          </ul>
        </div>

        <div class="card">
          <h3>üé® Design & Presentation</h3>
          <p>Use the app during your presentation to show live data and run the quiz as an interactive activity for your audience.</p>
        </div>
      </div>

      <div class="info-box" aria-live="polite">
        <strong>Tip:</strong> Start at "Calculator" to enter values and build a dataset for your presentation. Each calculation adds a new bar to the chart so you can compare runs.
      </div>
    </section>

    <section id="calculator">
      <h2>Carbon Footprint Calculator</h2>
      <p>Estimate a reaction's carbon footprint and track multiple runs in the chart below.</p>

      <div>
        <label for="energy">Energy used (kWh)</label><br/>
        <input id="energy" type="number" min="0" step="0.01" placeholder="e.g., 12.5">
      </div>
      <div>
        <label for="waste">Waste produced (kg)</label><br/>
        <input id="waste" type="number" min="0" step="0.01" placeholder="e.g., 0.5">
      </div>

      <div>
        <button class="primary" onclick="calculateFootprint()">Calculate & Add to Chart</button>
      </div>

      <div class="result" id="result" aria-live="polite"></div>
      <div class="progress-bar" aria-hidden="false"><div class="progress" id="progress"></div></div>

      <!-- Chart container -->
      <canvas id="footprintChart" aria-label="Carbon footprint chart" role="img"></canvas>

      <div style="margin-top:.8rem; font-size:.95rem; color:#40573a;">
        <em>Tip:</em> Bars are color-coded: green = low, yellow = medium, red = high emissions.
      </div>
    </section>

    <section id="simulator">
      <h2>Reaction Simulator</h2>
      <p>Type element symbols (e.g., H, O, Na) and click simulate to see a friendly description of a reaction.</p>

      <div>
        <input id="element1" type="text" placeholder="Element 1 (e.g., H)" maxlength="3" />
        <input id="element2" type="text" placeholder="Element 2 (e.g., O)" maxlength="3" />
      </div>
      <div>
        <button class="primary" onclick="simulateReaction()">Simulate</button>
      </div>

      <div class="result" id="reactionResult" aria-live="polite"></div>
    </section>

    <section id="quiz">
      <h2>Green Chemistry Quiz</h2>
      <p id="questionText" style="font-weight:600; margin-top:.4rem;"></p>

      <div class="quiz-answers" id="answers" aria-live="polite"></div>

      <div class="result" id="quizResult" style="margin-top:.6rem;"></div>

      <div class="progress-bar" style="margin-top:.6rem;"><div class="progress" id="quizProgress"></div></div>

      <div style="margin-top:0.8rem;">
        <button class="primary" onclick="resetQuiz()">Restart Quiz</button>
      </div>
    </section>

    <section id="info">
      <h2>üî¨ STREAM Connections</h2>
      <div class="info-box"><strong>Science:</strong> Green chemistry reduces hazardous substances and designs safer products.</div>
      <div class="info-box"><strong>Technology:</strong> This app demonstrates data-driven learning (Chart.js + JavaScript).</div>
      <div class="info-box"><strong>Engineering:</strong> Engineers design processes to reduce energy & material waste.</div>
      <div class="info-box"><strong>Art & Math:</strong> Visual design + charts help communicate scientific results.</div>
    </section>

    <section id="tips">
      <h2>Eco Tips & Innovations</h2>
      <ul>
        <li>Use catalysts to reduce energy demand.</li>
        <li>Replace hazardous solvents with greener alternatives.</li>
        <li>Model reactions digitally before running them in the lab.</li>
      </ul>
    </section>
  </main>

  <footer>¬© 2025 EcoChem Tracker | STREAM Project</footer>

<script>
/* ========= State ========= */
let chart = null;
const footprints = []; // numeric values
let quizIndex = 0;
let quizScore = 0;

/* ========= Quiz data ========= */
const quizData = [
  { question: "Which is a principle of green chemistry?", answers: ["Use renewable feedstocks", "Increase waste"], correct: 0 },
  { question: "Which energy source is sustainable?", answers: ["Solar", "Coal"], correct: 0 },
  { question: "Which solvent is eco-friendly?", answers: ["Water", "Benzene"], correct: 0 },
  { question: "What does atom economy measure?", answers: ["Efficiency of reactant use", "Reaction speed"], correct: 0 }
];

/* ========= UI Helpers ========= */
function showSection(id) {
  document.querySelectorAll('main section').forEach(s => s.classList.remove('active'));
  const sec = document.getElementById(id);
  if (!sec) return;
  sec.classList.add('active');

  // When calculator opened, ensure chart exists and is updated
  if (id === 'calculator') {
    ensureChartInitialized();
    updateChart();
  }

  // When quiz opened, load current question (or show completed state)
  if (id === 'quiz') {
    // If quiz hasn't started or is mid-quiz, load appropriate question
    if (quizIndex < quizData.length) loadQuestion();
    else showQuizComplete();
  }
}

/* ========= Chart functions ========= */
function ensureChartInitialized() {
  const canvas = document.getElementById('footprintChart');
  if (!canvas) return;
  // If already created, do nothing (Chart.js handles hidden->visible)
  if (chart) return;

  const ctx = canvas.getContext('2d');
  chart = new Chart(ctx, {
    type: 'bar',
    data: {
      labels: [],
      datasets: [{
        label: 'kg CO‚ÇÇ Produced',
        data: [],
        backgroundColor: []
      }]
    },
    options: {
      maintainAspectRatio: false,
      responsive: true,
      scales: {
        y: { beginAtZero: true, title: { display: true, text: 'kg CO‚ÇÇ' } }
      },
      plugins: {
        legend: { display: false },
        tooltip: { mode: 'index', intersect: false }
      }
    }
  });
}

function emissionColor(value) {
  // returns hex color based on numeric footprint
  // thresholds can be adjusted for your context
  const v = Number(value);
  if (isNaN(v)) return '#66bb6a';
  if (v < 20) return '#66bb6a';      // green
  if (v < 50) return '#fdd835';      // yellow-ish
  return '#e53935';                  // red
}

function updateChart() {
  if (!chart) return;
  chart.data.labels = footprints.map((_, i) => `Run ${i + 1}`);
  chart.data.datasets[0].data = footprints.slice();
  chart.data.datasets[0].backgroundColor = footprints.map(emissionColor);
  // Optional: adjust y max to be slightly above highest value for clarity
  const maxVal = Math.max(10, ...footprints.map(v => Number(v)));
  chart.options.scales.y.max = Math.ceil(maxVal * 1.15);
  chart.update();
}

/* ========= Calculator ========= */
function calculateFootprint() {
  // ensure chart exists if user calculates without visiting calculator section
  ensureChartInitialized();

  const energyIn = parseFloat(document.getElementById('energy').value) || 0;
  const wasteIn = parseFloat(document.getElementById('waste').value) || 0;
  // footprint formula (example): energy*0.5 + waste*2
  const footprint = Number((energyIn * 0.5 + wasteIn * 2).toFixed(2));

  // update UI
  document.getElementById('result').innerText = `Estimated Carbon Footprint: ${footprint} kg CO‚ÇÇ`;
  const prog = Math.min((footprint / 100) * 100, 100);
  document.getElementById('progress').style.width = `${prog}%`;

  // add to dataset and redraw
  footprints.push(footprint);
  updateChart();
}

/* ========= Simulator ========= */
function simulateReaction() {
  const e1 = document.getElementById('element1').value.trim().toUpperCase();
  const e2 = document.getElementById('element2').value.trim().toUpperCase();
  const out = document.getElementById('reactionResult');

  const known = {
    "H+O": "üíß You created water (H‚ÇÇO)!",
    "O+H": "üíß You created water (H‚ÇÇO)!",
    "C+O2": "üî• You formed carbon dioxide (CO‚ÇÇ), a greenhouse gas.",
    "O2+C": "üî• You formed carbon dioxide (CO‚ÇÇ), a greenhouse gas.",
    "N+H": "üåø You made ammonia (NH‚ÇÉ), used in fertilizers.",
    "H+N": "üåø You made ammonia (NH‚ÇÉ), used in fertilizers.",
    "NA+CL": "üßÇ You made table salt (NaCl)!",
    "FE+O": "üß≤ You formed iron oxide (rust).",
    "MG+O": "‚ú® You made magnesium oxide (MgO)."
  };

  const key = `${e1}+${e2}`;
  const res = known[key] || known[`${e2}+${e1}`] || "‚öóÔ∏è No known reaction ‚Äî try different elements or use correct chemical symbols!";
  out.innerText = res;
}

/* ========= Quiz functions ========= */
function loadQuestion() {
  if (quizIndex >= quizData.length) return showQuizComplete();
  const q = quizData[quizIndex];
  document.getElementById('questionText').innerText = `Q${quizIndex + 1}. ${q.question}`;
  const answersDiv = document.getElementById('answers');
  answersDiv.innerHTML = '';
  q.answers.forEach((ans, i) => {
    const btn = document.createElement('button');
    btn.type = 'button';
    btn.innerText = ans;
    btn.onclick = () => checkAnswer(i === q.correct);
    answersDiv.appendChild(btn);
  });
  // update progress bar
  const progPct = Math.round((quizIndex / quizData.length) * 100);
  document.getElementById('quizProgress').style.width = `${progPct}%`;
  document.getElementById('quizResult').innerText = '';
}

function checkAnswer(isCorrect) {
  const out = document.getElementById('quizResult');
  if (isCorrect) {
    quizScore += 10;
    out.innerText = '‚úÖ Correct!';
  } else {
    out.innerText = '‚ùå Try again!';
  }
  quizIndex++;
  setTimeout(() => {
    if (quizIndex < quizData.length) loadQuestion();
    else showQuizComplete();
  }, 800);
}

function showQuizComplete() {
  document.getElementById('questionText').innerText = 'Quiz Complete!';
  document.getElementById('answers').innerHTML = '';
  document.getElementById('quizResult').innerText = `üéâ Your score: ${quizScore} pts`;
  document.getElementById('quizProgress').style.width = '100%';
}

function resetQuiz() {
  quizIndex = 0;
  quizScore = 0;
  document.getElementById('quizProgress').style.width = '0%';
  loadQuestion();
  // if quiz section is not active, navigate to it so user sees questions
  showSection('quiz');
}

/* ========= Initialization ========= */
window.addEventListener('DOMContentLoaded', () => {
  // show home by default
  showSection('home');
  // Chart intentionally NOT initialized here (will initialize when calculator opens)
  // Prepare quiz container so it's usable when opened
  // If user directly opens quiz via nav, showSection('quiz') will load question
});
</script>
</body>
</html>
